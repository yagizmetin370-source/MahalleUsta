{% extends 'base.html' %}
{% block title %}Panelim â€“ MahalleUsta{% endblock %}
{% block content %}
<div class="dashboard-page">
  <div class="dashboard-hero">
    <div class="dashboard-hero-inner">
      <div>
        <h1 class="dashboard-hero-title">Merhaba, {{ provider.full_name.split()[0] }}! ðŸ‘‹</h1>
        <p class="dashboard-hero-sub">Hizmet veren panelinize hoÅŸ geldiniz.</p>
        {% if not provider.is_approved %}
        <div class="status-badge status-pending mt-2">
          <i class="fas fa-clock"></i> Admin onayÄ± bekleniyor
        </div>
        {% else %}
        <div class="status-badge status-approved mt-2">
          <i class="fas fa-check-circle"></i> Profiliniz yayÄ±nda
        </div>
        {% endif %}
      </div>
      <div class="dashboard-hero-actions">
        <a href="{{ url_for('provider.edit_profile') }}" class="btn btn-outline-white">
          <i class="fas fa-edit"></i> Profili DÃ¼zenle
        </a>
        {% if provider.is_approved %}
        <a href="{{ url_for('main.provider_detail', provider_id=provider.id) }}" class="btn btn-accent">
          <i class="fas fa-eye"></i> Profili GÃ¶r
        </a>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="dashboard-body">
    <!-- Sidebar -->
    <div>
      <div class="stat-grid-2">
        <div class="stat-card">
          <div class="stat-num" style="color:var(--accent);">{{ '%.1f'|format(provider.avg_rating) if provider.avg_rating else 'â€“' }}</div>
          <div class="stat-label">Ort. Puan</div>
        </div>
        <div class="stat-card">
          <div class="stat-num">{{ provider.review_count }}</div>
          <div class="stat-label">Yorum</div>
        </div>
        <div class="stat-card">
          <div class="stat-num">{{ provider.total_services }}</div>
          <div class="stat-label">Hizmet</div>
        </div>
        <div class="stat-card">
          <div class="stat-num" style="font-size:1.1rem;color:{{ 'var(--success)' if provider.is_verified else 'var(--gray-400)' }};">
            {{ 'âœ“' if provider.is_verified else 'â€“' }}
          </div>
          <div class="stat-label">DoÄŸrulanmÄ±ÅŸ</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header"><i class="fas fa-user"></i><h3>Profil Bilgisi</h3></div>
        <div class="card-body" style="padding:20px;">
          <div style="text-align:center;margin-bottom:16px;">
            {% if provider.profile_photo and provider.profile_photo != 'default.png' %}
            <img src="{{ url_for('static', filename='uploads/' + provider.profile_photo) }}"
                 style="width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--gray-200);">
            {% else %}
            <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--blue-light),var(--accent));display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;color:white;margin:0 auto;">
              {{ provider.full_name[0].upper() }}
            </div>
            {% endif %}
            <h3 style="margin-top:10px;font-size:1rem;">{{ provider.full_name }}</h3>
            <p class="text-muted text-sm">{{ categories.get(provider.category,'') }}</p>
          </div>
          <div class="contact-row" style="padding:10px 0;">
            <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
            <div><div class="contact-label">Konum</div><div class="contact-value text-sm">{{ provider.neighborhood }}, {{ provider.district }}</div></div>
          </div>
          <div class="contact-row" style="padding:10px 0;">
            <div class="contact-icon"><i class="fas fa-phone"></i></div>
            <div><div class="contact-label">Telefon</div><div class="contact-value text-sm">{{ provider.phone }}</div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main -->
    <div>
      <div class="card">
        <div class="card-header">
          <i class="fas fa-star" style="color:var(--accent);"></i>
          <h3>Son Yorumlar</h3>
        </div>
        <div class="card-body">
          {% if recent_reviews %}
            {% for review in recent_reviews %}
            <div class="review-item">
              <div class="review-top">
                <div class="review-author">
                  <div class="review-author-avatar">{{ review.author.username[0].upper() }}</div>
                  <div>
                    <div>{{ review.author.username }}</div>
                    <div class="stars" style="margin-top:2px;">
                      {% for i in range(1,6) %}<span class="star {{ 'filled' if i <= review.rating }}" style="font-size:0.8rem;">â˜…</span>{% endfor %}
                      <span class="rating-text">{{ review.rating }}/5</span>
                    </div>
                  </div>
                </div>
                <span class="review-date">{{ review.created_at.strftime('%d.%m.%Y') }}</span>
              </div>
              {% if review.comment %}<p class="review-text">{{ review.comment }}</p>{% endif %}
            </div>
            {% endfor %}
          {% else %}
          <div style="text-align:center;padding:40px;color:var(--gray-400);">
            <i class="fas fa-comment-slash" style="font-size:3rem;margin-bottom:16px;display:block;"></i>
            HenÃ¼z yorum almadÄ±nÄ±z.
          </div>
          {% endif %}
        </div>
      </div>

      <div class="card">
        <div class="card-header"><i class="fas fa-lightbulb" style="color:var(--accent);"></i><h3>BaÅŸarÄ± Ä°puÃ§larÄ±</h3></div>
        <div class="card-body">
          <ul style="color:var(--gray-600);font-size:0.9rem;list-style:none;display:flex;flex-direction:column;gap:12px;">
            <li style="display:flex;gap:10px;"><span style="color:var(--success);">âœ“</span> Profil fotoÄŸrafÄ± ekleyin â€“ gÃ¼veni %70 artÄ±rÄ±r</li>
            <li style="display:flex;gap:10px;"><span style="color:var(--success);">âœ“</span> AÃ§Ä±klamanÄ±zÄ± detaylÄ± yazÄ±n, uzmanlÄ±ÄŸÄ±nÄ±zÄ± belirtin</li>
            <li style="display:flex;gap:10px;"><span style="color:var(--success);">âœ“</span> MÃ¼ÅŸterilerden yorum yazmalarÄ±nÄ± isteyin</li>
            <li style="display:flex;gap:10px;"><span style="color:var(--success);">âœ“</span> Telefona hÄ±zlÄ± dÃ¶nÃ¼ÅŸ yapÄ±n (ilk 1 saatte)</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
